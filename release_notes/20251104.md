# Release Notes - November 4, 2025

## Summary

This release introduces horizontal mouse scroll support and enhances screen capture workflow efficiency through strategic mouse button placement. The update fixes critical build errors by migrating to RGB Matrix keycodes and ensures full QMK standards compliance for mouse controls.

---

## Key Changes

### 1. **Horizontal Mouse Scroll Support**

**Problem Solved**: Previous firmware lacked keyboard-based horizontal mouse scroll control, limiting navigation efficiency in wide documents and spreadsheets.

**Solution**: Added horizontal mouse wheel keycodes to Layer 4 (_LEFT_UP):

- **Layer 4, Row 4** (Bottom row, right side):
  - `MS_WHLR` - Mouse Wheel Right (horizontal scroll →)
  - `MS_WHLL` - Mouse Wheel Left (horizontal scroll ←)
  - `MS_WHLU` - Mouse Wheel Up (vertical scroll ↑)
  - `MS_WHLD` - Mouse Wheel Down (vertical scroll ↓)

**Visual Layout** (Layer 4, Row 4, Right Side):
```
┌────────┬────────┬────────┬────────┬────────┬────────┐
│MS_WHLR │MS_WHLU │MS_WHLD │MS_WHLL │ _______│ _______│
└────────┴────────┴────────┴────────┴────────┴────────┘
```

### 2. **Enhanced Screen Capture Workflow**

**New Feature**: Added mouse buttons at Fn3+Shift position for one-handed screen capture area selection.

**Strategic Button Placement**:
- **Row 3, Column 1**: `MS_BTN2` (Right-click) at Left Shift position
- **Row 4, Column 1**: `MS_BTN1` (Left-click) at bottom-left corner

**Use Case Workflow**:
1. Press **Fn3+7** to enter macOS screen capture mode (Cmd+Shift+4)
2. Hold **Fn3+Shift** to activate `MS_BTN2` (right-click equivalent)
3. Use **H/J/K/L** keys to move cursor and select capture area
4. Release to capture

**Benefits**:
- One-handed operation without moving hand to mouse
- Precise area selection using keyboard navigation
- Faster screen capture workflow integration

**Visual Layout** (Layer 4, Rows 3-4, Left Side):
```
┌────────┬────────┬────────┬────────┬────────┬────────┐
│MS_BTN2 │ _______│ _______│ _______│ RM_SPDU│ _______│  Row 3
├────────┼────────┼────────┼────────┼────────┼────────┤
│MS_BTN1 │ _______│ _______│ _______│ RM_SPDD│ _______│  Row 4
└────────┴────────┴────────┴────────┴────────┴────────┘
```

### 3. **RGB Matrix Keycodes Migration**

**Technical Update**: Migrated from deprecated RGBLIGHT keycodes to modern RGB Matrix standard.

**Keycode Changes**:
- **Hue Control**:
  - `RGB_HUI` → `RM_HUEU` (Hue Up)
  - `RGB_HUD` → `RM_HUED` (Hue Down)

- **Saturation Control**:
  - `RGB_SAI` → `RM_SATU` (Saturation Up)
  - `RGB_SAD` → `RM_SATD` (Saturation Down)

- **Brightness Control**:
  - `RGB_VAI` → `RM_VALU` (Value/Brightness Up)
  - `RGB_VAD` → `RM_VALD` (Value/Brightness Down)

- **Mode Control**:
  - `RGB_MOD` → `RM_NEXT` (Next animation mode)
  - `RGB_M_P` → `RM_TOGG` (Toggle RGB Matrix on/off)
  - `RGB_M_B` → `RM_PREV` (Previous animation mode)
  - `RGB_M_R` → `RM_SPDU` (Speed Up)
  - `RGB_M_SW` → `RM_SPDD` (Speed Down)

**Affected Layers**:
- Layer 2 (_RIGHT_UNDER): Hue/Saturation/Brightness controls
- Layer 3 (_BOTH_UNDER): Mode cycling controls
- Layer 4 (_LEFT_UP): Toggle and mode controls

### 4. **Mouse Keycodes Standardization**

**Compliance Update**: Updated all mouse keycodes to QMK official standards.

**Button Keycodes** (Layer 4):
- `KC_BTN1` → `MS_BTN1` (Left-click)
- `KC_BTN2` → `MS_BTN2` (Right-click)
- `KC_BTN3` → `MS_BTN3` (Middle-click)
- `KC_BTN4` → `MS_BTN4` (Back button)

**Movement Keycodes** (Layer 4, Row 3):
- `KC_MS_L` → `MS_LEFT` (Move left)
- `KC_MS_D` → `MS_DOWN` (Move down)
- `KC_MS_U` → `MS_UP` (Move up)
- `KC_MS_R` → `MS_RGHT` (Move right)

### 5. **macOS System Integration**

**New Shortcuts Defined**:
- `KC_MCTL` = `LGUI(KC_UP)` - Mission Control (Cmd+↑)
- `KC_LPAD` = `LGUI(KC_SPC)` - Launchpad (Cmd+Space)

**Location**: Layer 3 (_BOTH_UNDER), top row
- Used for quick access to macOS system features
- Positioned for easy activation with both thumb keys held

### 6. **Build System Improvements**

**Header Inclusion**:
```c
#ifdef RGB_MATRIX_ENABLE
    #include "rgb_matrix.h"
#endif
```

**Rationale**:
- Ensures RGB Matrix keycodes are properly defined
- Conditional compilation prevents conflicts
- Maintains compatibility with different build configurations

**Build Results**:
- ✅ Compilation successful: `keebio_iris_rev7_zerodice0.hex`
- ✅ Firmware size: 26,794 / 28,672 bytes (93% usage, 1,878 bytes free)
- ✅ All keycodes properly defined and recognized
- ✅ No build warnings or errors

---

## Layer Overview (Updated)

### Layer 0: _BASIC (Default)
- Standard QWERTY layout
- No changes from previous version
- Left thumb: Cmd, LEFT_UNDER (layer switch), Enter
- Right thumb: Space, RIGHT_UNDER (layer switch), Right Alt

### Layer 1: _LEFT_UNDER
- Number pad and symbols
- No changes from previous version

### Layer 2: _RIGHT_UNDER
- Function keys (F1-F12)
- Media controls
- **Updated**: RGB Matrix controls using RM_* keycodes
  - Row 2: RM_HUEU, RM_SATU, RM_VALU (Hue/Sat/Brightness Up)
  - Row 3: RM_HUED, RM_SATD, RM_VALD (Hue/Sat/Brightness Down)

### Layer 3: _BOTH_UNDER (Tri-Layer)
- System shortcuts
- **Updated**: RGB mode controls (RM_NEXT for cycling)
- **New**: KC_MCTL (Mission Control), KC_LPAD (Launchpad)

### Layer 4: _LEFT_UP
- **Enhanced**: Mouse control with horizontal scroll support
- **New**: Mouse buttons at Shift position for screen capture workflow
- macOS navigation shortcuts (Back, Forward, Up, Down)
- Screenshot shortcuts (Cmd+Shift+3/4/5 variants)

**Layer 4 Complete Layout**:
```
Row 1: [_______][_______][_______][_______][RM_TOGG][RM_NEXT]    [KC_SG4 ][KC_SGC4][KC_SG3 ][KC_SGC3][KC_SG5 ][_______]
Row 2: [_______][_______][_______][_______][RM_PREV][BL_STEP]    [MS_BTN1][MS_BTN2][MS_BTN3][MS_BTN4][GO_BACK][GO_FORW]
Row 3: [MS_BTN2][_______][_______][_______][RM_SPDU][_______]    [MS_LEFT][MS_DOWN][MS_UP  ][MS_RGHT][GO_UPPR][GO_LOWR]
Row 4: [MS_BTN1][_______][_______][_______][RM_SPDD][_______]    [MS_WHLR][MS_WHLU][MS_WHLD][MS_WHLL][_______][_______]
```

---

## Technical Specifications

### Hardware Support
- **Keyboards**: Keebio Iris Rev7, Iris CE Rev1
- **RGB Matrix**: Per-key RGB lighting (hardware-dependent)
- **Mouse Control**: Full 4-button + 4-directional scroll support

### Build Configuration (Unchanged)
```makefile
MOUSEKEY_ENABLE = yes        # Required for mouse features
EXTRAKEY_ENABLE = yes        # Media keys support
RGB_MATRIX_ENABLE = yes      # RGB Matrix (not RGBLIGHT)
SPLIT_KEYBOARD = yes         # Split keyboard support
LTO_ENABLE = yes             # Link-time optimization
```

### Firmware Specifications
- **Compiled Size**: 26,794 bytes / 28,672 bytes (93.45%)
- **Available Space**: 1,878 bytes
- **QMK Version**: Compatible with QMK 0.24.0+
- **Platform**: macOS-optimized (partial Windows/Linux compatibility)

---

## Migration Notes

### From Previous Version (October 16, 2025)

**Automatic Changes** (No user action needed):
- RGB keycodes automatically updated to RM_* prefix
- Mouse keycodes standardized to MS_* prefix
- Build errors resolved

**New Features to Test**:
1. **Horizontal Scroll**: Layer 4 + bottom row (MS_WHLR, MS_WHLL)
2. **Screen Capture Workflow**: Fn3+7 → Fn3+Shift+H/J/K/L
3. **Mouse Buttons**: Fn3+Shift (MS_BTN2), Fn3+bottom-left (MS_BTN1)

**No Breaking Changes**:
- All existing functionality preserved
- Layer structure unchanged
- Key positions remain the same

---

## Known Issues & Limitations

### Platform Compatibility
- ✅ **macOS**: Full functionality (tested)
- ⚠️ **Windows/Linux**: Partial compatibility
  - Mouse controls: Fully functional
  - RGB Matrix: Fully functional
  - macOS shortcuts (Cmd+↑, Cmd+Space): Not applicable
  - Horizontal scroll: May behave differently depending on OS settings

### Hardware Limitations
- RGB Matrix features require compatible hardware (Iris CE Rev1)
- Iris Rev7 may have limited or no RGB Matrix support

---

## 요약

이 릴리즈는 마우스 좌우 스크롤 지원을 도입하고 전략적 마우스 버튼 배치를 통해 스크린 캡처 워크플로우 효율성을 향상시킵니다. RGB Matrix 키코드로 마이그레이션하여 중요한 빌드 오류를 수정하고 마우스 제어에 대한 QMK 표준 완전 준수를 보장합니다.

---

## 주요 변경사항

### 1. **마우스 좌우 스크롤 지원**

**해결된 문제**: 이전 펌웨어에는 키보드 기반 좌우 마우스 스크롤 제어가 없어 넓은 문서 및 스프레드시트 탐색 효율성이 제한되었습니다.

**해결 방법**: 레이어 4 (_LEFT_UP)에 좌우 마우스 휠 키코드 추가:

- **레이어 4, 4행** (하단 행, 오른쪽):
  - `MS_WHLR` - 마우스 휠 오른쪽 (좌우 스크롤 →)
  - `MS_WHLL` - 마우스 휠 왼쪽 (좌우 스크롤 ←)
  - `MS_WHLU` - 마우스 휠 위 (수직 스크롤 ↑)
  - `MS_WHLD` - 마우스 휠 아래 (수직 스크롤 ↓)

**시각적 레이아웃** (레이어 4, 4행, 오른쪽):
```
┌────────┬────────┬────────┬────────┬────────┬────────┐
│MS_WHLR │MS_WHLU │MS_WHLD │MS_WHLL │ _______│ _______│
└────────┴────────┴────────┴────────┴────────┴────────┘
```

### 2. **향상된 스크린 캡처 워크플로우**

**새로운 기능**: Fn3+Shift 위치에 마우스 버튼을 추가하여 한 손으로 스크린 캡처 영역을 선택할 수 있습니다.

**전략적 버튼 배치**:
- **3행, 1열**: `MS_BTN2` (우클릭) - 왼쪽 Shift 위치
- **4행, 1열**: `MS_BTN1` (좌클릭) - 왼쪽 하단 모서리

**사용 워크플로우**:
1. **Fn3+7** 키를 눌러 macOS 스크린 캡처 모드 진입 (Cmd+Shift+4)
2. **Fn3+Shift**를 누른 상태 유지 (`MS_BTN2` 우클릭 동작)
3. **H/J/K/L** 키를 사용하여 커서를 이동하고 캡처 영역 선택
4. 손을 떼면 캡처 완료

**장점**:
- 마우스로 손을 옮기지 않고 한 손으로 조작 가능
- 키보드 내비게이션으로 정밀한 영역 선택
- 빠른 스크린 캡처 워크플로우 통합

**시각적 레이아웃** (레이어 4, 3-4행, 왼쪽):
```
┌────────┬────────┬────────┬────────┬────────┬────────┐
│MS_BTN2 │ _______│ _______│ _______│ RM_SPDU│ _______│  3행
├────────┼────────┼────────┼────────┼────────┼────────┤
│MS_BTN1 │ _______│ _______│ _______│ RM_SPDD│ _______│  4행
└────────┴────────┴────────┴────────┴────────┴────────┘
```

### 3. **RGB Matrix 키코드 마이그레이션**

**기술 업데이트**: 사용 중단된 RGBLIGHT 키코드에서 최신 RGB Matrix 표준으로 마이그레이션.

**키코드 변경사항**:
- **색상 제어**:
  - `RGB_HUI` → `RM_HUEU` (색상 증가)
  - `RGB_HUD` → `RM_HUED` (색상 감소)

- **채도 제어**:
  - `RGB_SAI` → `RM_SATU` (채도 증가)
  - `RGB_SAD` → `RM_SATD` (채도 감소)

- **밝기 제어**:
  - `RGB_VAI` → `RM_VALU` (밝기 증가)
  - `RGB_VAD` → `RM_VALD` (밝기 감소)

- **모드 제어**:
  - `RGB_MOD` → `RM_NEXT` (다음 애니메이션 모드)
  - `RGB_M_P` → `RM_TOGG` (RGB Matrix 켜기/끄기)
  - `RGB_M_B` → `RM_PREV` (이전 애니메이션 모드)
  - `RGB_M_R` → `RM_SPDU` (속도 증가)
  - `RGB_M_SW` → `RM_SPDD` (속도 감소)

**영향받는 레이어**:
- 레이어 2 (_RIGHT_UNDER): 색상/채도/밝기 제어
- 레이어 3 (_BOTH_UNDER): 모드 순환 제어
- 레이어 4 (_LEFT_UP): 토글 및 모드 제어

### 4. **마우스 키코드 표준화**

**준수 업데이트**: 모든 마우스 키코드를 QMK 공식 표준으로 업데이트.

**버튼 키코드** (레이어 4):
- `KC_BTN1` → `MS_BTN1` (좌클릭)
- `KC_BTN2` → `MS_BTN2` (우클릭)
- `KC_BTN3` → `MS_BTN3` (가운데 클릭)
- `KC_BTN4` → `MS_BTN4` (뒤로 버튼)

**이동 키코드** (레이어 4, 3행):
- `KC_MS_L` → `MS_LEFT` (왼쪽 이동)
- `KC_MS_D` → `MS_DOWN` (아래 이동)
- `KC_MS_U` → `MS_UP` (위 이동)
- `KC_MS_R` → `MS_RGHT` (오른쪽 이동)

### 5. **macOS 시스템 통합**

**새로 정의된 단축키**:
- `KC_MCTL` = `LGUI(KC_UP)` - 미션 컨트롤 (Cmd+↑)
- `KC_LPAD` = `LGUI(KC_SPC)` - 런치패드 (Cmd+Space)

**위치**: 레이어 3 (_BOTH_UNDER), 상단 행
- macOS 시스템 기능에 빠른 접근 제공
- 두 엄지 키를 누른 상태에서 쉽게 활성화할 수 있는 위치

### 6. **빌드 시스템 개선**

**헤더 포함**:
```c
#ifdef RGB_MATRIX_ENABLE
    #include "rgb_matrix.h"
#endif
```

**이유**:
- RGB Matrix 키코드가 적절히 정의되도록 보장
- 조건부 컴파일로 충돌 방지
- 다양한 빌드 구성과 호환성 유지

**빌드 결과**:
- ✅ 컴파일 성공: `keebio_iris_rev7_zerodice0.hex`
- ✅ 펌웨어 크기: 26,794 / 28,672 바이트 (93% 사용, 1,878 바이트 여유)
- ✅ 모든 키코드 적절히 정의되고 인식됨
- ✅ 빌드 경고 또는 오류 없음

---

## 레이어 개요 (업데이트됨)

### 레이어 0: _BASIC (기본값)
- 표준 QWERTY 레이아웃
- 이전 버전에서 변경 없음
- 왼쪽 엄지: Cmd, LEFT_UNDER (레이어 전환), Enter
- 오른쪽 엄지: Space, RIGHT_UNDER (레이어 전환), Right Alt

### 레이어 1: _LEFT_UNDER
- 숫자판 및 기호
- 이전 버전에서 변경 없음

### 레이어 2: _RIGHT_UNDER
- 기능 키 (F1-F12)
- 미디어 제어
- **업데이트됨**: RM_* 키코드를 사용한 RGB Matrix 제어
  - 2행: RM_HUEU, RM_SATU, RM_VALU (색상/채도/밝기 증가)
  - 3행: RM_HUED, RM_SATD, RM_VALD (색상/채도/밝기 감소)

### 레이어 3: _BOTH_UNDER (트라이-레이어)
- 시스템 단축키
- **업데이트됨**: RGB 모드 제어 (순환용 RM_NEXT)
- **새로운 기능**: KC_MCTL (미션 컨트롤), KC_LPAD (런치패드)

### 레이어 4: _LEFT_UP
- **향상됨**: 좌우 스크롤 지원 마우스 제어
- **새로운 기능**: 스크린 캡처 워크플로우용 Shift 위치 마우스 버튼
- macOS 탐색 단축키 (뒤로, 앞으로, 위, 아래)
- 스크린샷 단축키 (Cmd+Shift+3/4/5 변형)

**레이어 4 전체 레이아웃**:
```
1행: [_______][_______][_______][_______][RM_TOGG][RM_NEXT]    [KC_SG4 ][KC_SGC4][KC_SG3 ][KC_SGC3][KC_SG5 ][_______]
2행: [_______][_______][_______][_______][RM_PREV][BL_STEP]    [MS_BTN1][MS_BTN2][MS_BTN3][MS_BTN4][GO_BACK][GO_FORW]
3행: [MS_BTN2][_______][_______][_______][RM_SPDU][_______]    [MS_LEFT][MS_DOWN][MS_UP  ][MS_RGHT][GO_UPPR][GO_LOWR]
4행: [MS_BTN1][_______][_______][_______][RM_SPDD][_______]    [MS_WHLR][MS_WHLU][MS_WHLD][MS_WHLL][_______][_______]
```

---

## 기술 사양

### 하드웨어 지원
- **키보드**: Keebio Iris Rev7, Iris CE Rev1
- **RGB Matrix**: 키별 RGB 조명 (하드웨어 의존)
- **마우스 제어**: 4버튼 + 4방향 스크롤 완전 지원

### 빌드 구성 (변경 없음)
```makefile
MOUSEKEY_ENABLE = yes        # 마우스 기능 필수
EXTRAKEY_ENABLE = yes        # 미디어 키 지원
RGB_MATRIX_ENABLE = yes      # RGB Matrix (RGBLIGHT 아님)
SPLIT_KEYBOARD = yes         # 분할 키보드 지원
LTO_ENABLE = yes             # 링크 타임 최적화
```

### 펌웨어 사양
- **컴파일 크기**: 26,794 바이트 / 28,672 바이트 (93.45%)
- **사용 가능 공간**: 1,878 바이트
- **QMK 버전**: QMK 0.24.0+ 호환
- **플랫폼**: macOS 최적화 (Windows/Linux 부분 호환)

---

## 마이그레이션 참고사항

### 이전 버전 (2025년 10월 16일)에서 업데이트

**자동 변경사항** (사용자 조치 불필요):
- RGB 키코드가 자동으로 RM_* 접두사로 업데이트됨
- 마우스 키코드가 MS_* 접두사로 표준화됨
- 빌드 오류 해결됨

**테스트할 새로운 기능**:
1. **좌우 스크롤**: 레이어 4 + 하단 행 (MS_WHLR, MS_WHLL)
2. **스크린 캡처 워크플로우**: Fn3+7 → Fn3+Shift+H/J/K/L
3. **마우스 버튼**: Fn3+Shift (MS_BTN2), Fn3+하단-왼쪽 (MS_BTN1)

**호환성 유지**:
- 모든 기존 기능 보존
- 레이어 구조 변경 없음
- 키 위치 동일

---

## 알려진 문제 및 제한사항

### 플랫폼 호환성
- ✅ **macOS**: 완전한 기능 (테스트 완료)
- ⚠️ **Windows/Linux**: 부분 호환성
  - 마우스 제어: 완전 작동
  - RGB Matrix: 완전 작동
  - macOS 단축키 (Cmd+↑, Cmd+Space): 해당 없음
  - 좌우 스크롤: OS 설정에 따라 다르게 동작할 수 있음

### 하드웨어 제한사항
- RGB Matrix 기능은 호환 하드웨어 필요 (Iris CE Rev1)
- Iris Rev7은 RGB Matrix 지원이 제한적이거나 없을 수 있음
